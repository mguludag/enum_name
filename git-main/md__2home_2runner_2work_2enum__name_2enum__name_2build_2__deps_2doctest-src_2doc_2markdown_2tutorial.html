<!-- HTML header for doxygen 1.10.0-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
  <head>
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=11" />
    <meta name="generator" content="Doxygen 1.10.0" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>enum_name: Tutorial</title>
    <link href="tabs.css" rel="stylesheet" type="text/css" />
    <script type="text/javascript" src="jquery.js"></script>
    <script type="text/javascript" src="dynsections.js"></script>
    <script type="text/javascript" src="clipboard.js"></script>
    <script type="text/javascript" src="cookie.js"></script>
 <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
    <link href="doxygen.css" rel="stylesheet" type="text/css" />
    <script
      type="text/javascript"
      src="version_selector_handler.js"
    ></script>
  </head>
  <body>
      <div id="top">
        <!-- do not remove this div, it is closed by doxygen! -->
        <div id="titlearea">
          <table cellspacing="0" cellpadding="0">
            <tbody>
              <tr id="projectrow">
                <td id="projectalign">
                  <div id="projectname">
                    enum_name
                    <span id="projectnumber" />
                  </div>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
        <!-- end header part -->
      </div>
    </div>
  </body>
</html>
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Tutorial</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md177"></a> To get started with <b>doctest</b> all you need is to download the <a href="https://raw.githubusercontent.com/doctest/doctest/master/doctest/doctest.h"><b>latest version</b></a> which is just a single header and include it in your source files (or add this repository as a git submodule).</p>
<p>This tutorial assumes you can use the header directly: <code>#include "doctest.h"</code> - so it is either in the same folder with your test source files or you have set up the include paths to it in your build system properly.</p>
<p><a href="https://en.wikipedia.org/wiki/Test-driven_development">TDD</a> is not discussed in this tutorial.</p>
<h1><a class="anchor" id="autotoc_md178"></a>
A simple example</h1>
<p>Suppose we have a <code>factorial()</code> function that we want to test:</p>
<div class="fragment"><div class="line"> ++</div>
<div class="line"><span class="keywordtype">int</span> factorial(<span class="keywordtype">int</span> number) { <span class="keywordflow">return</span> number &lt;= 1 ? number : factorial(number - 1) * number; }</div>
</div><!-- fragment --><p>A complete compiling example with a self-registering test looks like this:</p>
<div class="fragment"><div class="line"> ++</div>
<div class="line"><span class="preprocessor">#define DOCTEST_CONFIG_IMPLEMENT_WITH_MAIN</span></div>
<div class="line"><span class="preprocessor">#include &quot;doctest.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> factorial(<span class="keywordtype">int</span> number) { <span class="keywordflow">return</span> number &lt;= 1 ? number : factorial(number - 1) * number; }</div>
<div class="line"> </div>
<div class="line">TEST_CASE(<span class="stringliteral">&quot;testing the factorial function&quot;</span>) {</div>
<div class="line">    CHECK(factorial(1) == 1);</div>
<div class="line">    CHECK(factorial(2) == 2);</div>
<div class="line">    CHECK(factorial(3) == 6);</div>
<div class="line">    CHECK(factorial(10) == 3628800);</div>
<div class="line">}</div>
</div><!-- fragment --><p>This will compile to a complete executable which responds to command line arguments. If you just run it with no arguments it will execute all test cases (in this case - just one), report any failures, report a summary of how many tests passed and failed and returns 0 on success and 1 if anything failed (useful if you just want a yes/no answer to: "did it work").</p>
<p>If you run this as written it will pass. Everything is good. Right? Well there is still a bug here. We missed to check if <code>factorial(0) == 1</code> so let's add that check as well:</p>
<div class="fragment"><div class="line"> ++</div>
<div class="line">TEST_CASE(<span class="stringliteral">&quot;testing the factorial function&quot;</span>) {</div>
<div class="line">    CHECK(factorial(0) == 1);</div>
<div class="line">    CHECK(factorial(1) == 1);</div>
<div class="line">    CHECK(factorial(2) == 2);</div>
<div class="line">    CHECK(factorial(3) == 6);</div>
<div class="line">    CHECK(factorial(10) == 3628800);</div>
<div class="line">}</div>
</div><!-- fragment --><p>Now we get a failure - something like:</p>
<div class="fragment"><div class="line">test.cpp(7) FAILED!</div>
<div class="line">  CHECK( factorial(0) == 1 )</div>
<div class="line">with expansion:</div>
<div class="line">  CHECK( 0 == 1 )</div>
</div><!-- fragment --><p>Note that we get the actual return value of <code>factorial(0)</code> printed for us (0) - even though we used a natural expression with the <code>==</code> operator. That lets us immediately see what the problem is.</p>
<p>Let's change the factorial function to:</p>
<div class="fragment"><div class="line"> ++</div>
<div class="line"><span class="keywordtype">int</span> factorial(<span class="keywordtype">int</span> number) { <span class="keywordflow">return</span> number &gt; 1 ? factorial(number - 1) * number : 1; }</div>
</div><!-- fragment --><p>Now all the tests pass.</p>
<p>Of course there are still more issues to do deal with. For example we'll hit problems when the return value starts to exceed the range of an int. With factorials that can happen quite quickly. You might want to add tests for such cases and decide how to handle them. We'll stop short of doing that here.</p>
<h1><a class="anchor" id="autotoc_md179"></a>
What did we do here?</h1>
<p>Although this was a simple test it's been enough to demonstrate a few things about how <b>doctest</b> is used.</p>
<ol type="1">
<li>All we did was <code>#define</code> one identifier and <code>#include</code> one header and we got everything - even an implementation of <code>main()</code> that will respond to command line arguments. You can only use that <code>#define</code> in one source file for (hopefully) obvious reasons. Once you have more than one file with unit tests in you'll just <code>#include "doctest.h"</code> and go. Usually it's a good idea to have a dedicated implementation file that just has <code>#define DOCTEST_CONFIG_IMPLEMENT_WITH_MAIN</code> and <code>#include "doctest.h"</code>. You can also provide your own implementation of main and drive <b>doctest</b> yourself - see <a class="el" href="md__2home_2runner_2work_2enum__name_2enum__name_2build_2__deps_2doctest-src_2doc_2markdown_2main.html"><b>supplying your own <code>main()</code></b></a>.</li>
<li>We introduce test cases with the <code>TEST_CASE</code> macro. It takes one argument - a free form test name (for more see <a class="el" href="md__2home_2runner_2work_2enum__name_2enum__name_2build_2__deps_2doctest-src_2doc_2markdown_2testcases.html"><b>Test cases and subcases</b></a>). The test name doesn't have to be unique. You can run sets of tests by specifying a wildcarded test name or a tag expression. See the <a class="el" href="md__2home_2runner_2work_2enum__name_2enum__name_2build_2__deps_2doctest-src_2doc_2markdown_2commandline.html"><b>command line</b></a> docs for more information on running tests.</li>
<li>The name is just a string. We haven't had to declare a function or method - or explicitly register the test case anywhere. Behind the scenes a function with a generated name is defined for you and automatically registered using static registry classes. By abstracting the function name away we can name our tests without the constraints of identifier names.</li>
<li>We write our individual test assertions using the <code>CHECK()</code> macro. Rather than a separate macro for each type of condition (equal, less than, greater than, etc.) we express the condition naturally using C++ syntax. Behind the scenes a simple expression template captures the left-hand-side and right-hand-side of the expression so we can display the values in our test report. There are other <a class="el" href="md__2home_2runner_2work_2enum__name_2enum__name_2build_2__deps_2doctest-src_2doc_2markdown_2assertions.html"><b>assertion macros</b></a> not covered in this tutorial - but because of this technique the number of them is drastically reduced.</li>
</ol>
<h1><a class="anchor" id="autotoc_md180"></a>
Test cases and subcases</h1>
<p>Most test frameworks have a class-based fixture mechanism - test cases map to methods on a class and common setup and teardown can be performed in <code>setup()</code> and <code>teardown()</code> methods (or constructor/ destructor in languages like C++ that support deterministic destruction).</p>
<p>While <b>doctest</b> fully supports this way of working there are a few problems with the approach. In particular the way your code must be split up and the blunt granularity of it may cause problems. You can only have one setup/ teardown pair across a set of methods but sometimes you want slightly different setup in each method or you may even want several levels of setup (a concept which we will clarify later on in this tutorial). It was <a href="http://jamesnewkirk.typepad.com/posts/2007/09/why-you-should-.html"><b>problems like these</b></a> that led James Newkirk who led the team that built NUnit to start again from scratch and build <a href="http://jamesnewkirk.typepad.com/posts/2007/09/announcing-xuni.html"><b>xUnit</b></a>).</p>
<p><b>doctest</b> takes a different approach (to both NUnit and xUnit) that is a more natural fit for C++ and the C family of languages.</p>
<p>This is best explained through an example:</p>
<div class="fragment"><div class="line"> ++</div>
<div class="line">TEST_CASE(<span class="stringliteral">&quot;vectors can be sized and resized&quot;</span>) {</div>
<div class="line">    std::vector&lt;int&gt; v(5);</div>
<div class="line"> </div>
<div class="line">    REQUIRE(v.size() == 5);</div>
<div class="line">    REQUIRE(v.capacity() &gt;= 5);</div>
<div class="line"> </div>
<div class="line">    SUBCASE(<span class="stringliteral">&quot;adding to the vector increases its size&quot;</span>) {</div>
<div class="line">        v.push_back(1);</div>
<div class="line"> </div>
<div class="line">        CHECK(v.size() == 6);</div>
<div class="line">        CHECK(v.capacity() &gt;= 6);</div>
<div class="line">    }</div>
<div class="line">    SUBCASE(<span class="stringliteral">&quot;reserving increases just the capacity&quot;</span>) {</div>
<div class="line">        v.reserve(6);</div>
<div class="line"> </div>
<div class="line">        CHECK(v.size() == 5);</div>
<div class="line">        CHECK(v.capacity() &gt;= 6);</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p>For each <code>SUBCASE()</code> the <code>TEST_CASE()</code> is executed from the start - so as we enter each subcase we know that the size is 5 and the capacity is at least 5. We enforce those requirements with the <code>REQUIRE()</code> macros at the top level so we can be confident in them. If a <code>CHECK()</code> fails - the test is marked as failed but the execution continues - but if a <code>REQUIRE()</code> fails - execution of the test stops.</p>
<p>This works because the <code>SUBCASE()</code> macro contains an if statement that calls back into <b>doctest</b> to see if the subcase should be executed. One leaf subcase is executed on each run through a <code>TEST_CASE()</code>. The other subcases are skipped. Next time the next subcase is executed and so on until no new subcases are encountered.</p>
<p>So far so good - this is already an improvement on the setup/teardown approach because now we see our setup code inline and use the stack. The power of subcases really shows when we start nesting them like in the example below:</p>
<table class="doxtable">
<tr>
<td>Code </td><td>Output </td></tr>
<tr>
<td><pre lang="c++">
#define DOCTEST_CONFIG_IMPLEMENT_WITH_MAIN
#include "doctest.h"
<br  />

#include &lt;iostream&gt;
using namespace std;
<br  />

TEST_CASE("lots of nested subcases") {
&#160;&#160;&#160;&#160;cout &lt;&lt; endl &lt;&lt; "root" &lt;&lt; endl;
&#160;&#160;&#160;&#160;SUBCASE("") {
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;cout &lt;&lt; "1" &lt;&lt; endl;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;SUBCASE("") { cout &lt;&lt; "1.1" &lt;&lt; endl; }
&#160;&#160;&#160;&#160;}
&#160;&#160;&#160;&#160;SUBCASE("") {   
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;cout &lt;&lt; "2" &lt;&lt; endl;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;SUBCASE("") { cout &lt;&lt; "2.1" &lt;&lt; endl; }
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;SUBCASE("") {
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;cout &lt;&lt; "2.2" &lt;&lt; endl;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;SUBCASE("") {
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;cout &lt;&lt; "2.2.1" &lt;&lt; endl;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;SUBCASE("") { cout &lt;&lt; "2.2.1.1" &lt;&lt; endl; }
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;SUBCASE("") { cout &lt;&lt; "2.2.1.2" &lt;&lt; endl; }
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;}
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;}
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;SUBCASE("") { cout &lt;&lt; "2.3" &lt;&lt; endl; }
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;SUBCASE("") { cout &lt;&lt; "2.4" &lt;&lt; endl; }
&#160;&#160;&#160;&#160;}
}
</pre> </td><td width="400"><pre>
root
1
1.1<br  />

root
2
2.1<br  />

root
2
2.2
2.2.1
2.2.1.1<br  />

root
2
2.2
2.2.1
2.2.1.2<br  />

root
2
2.3<br  />

root
2
2.4
</pre> </td></tr>
</table>
<p>Subcases can be nested to an arbitrary depth (limited only by your stack size). Each leaf subcase (a subcase that contains no nested subcases) will be executed exactly once on a separate path of execution from any other leaf subcase (so no leaf subcase can interfere with another). A fatal failure in a parent subcase will prevent nested subcases from running - but then that's the idea.</p>
<p>Keep in mind that even though <b>doctest</b> is <a href="faq.md#is-doctest-thread-aware"><b>thread-safe</b></a> - using subcases has to be done only in the main test runner thread and all threads spawned in a subcase ought to be joined before the end of that subcase and no new subcases should be entered while other threads with doctest assertions in them are still running.</p>
<h1><a class="anchor" id="autotoc_md181"></a>
Scaling up</h1>
<p>To keep the tutorial simple we put all our code in a single file. This is fine to get started - and makes jumping into <b>doctest</b> even quicker and easier. This is not really the best approach when you start writing more real-world tests.</p>
<p>The requirement is that the following block of code (<a class="el" href="md__2home_2runner_2work_2enum__name_2enum__name_2build_2__deps_2doctest-src_2doc_2markdown_2main.html"><b>or equivalent</b></a>):</p>
<div class="fragment"><div class="line"> ++</div>
<div class="line"><span class="preprocessor">#define DOCTEST_CONFIG_IMPLEMENT_WITH_MAIN</span></div>
<div class="line"><span class="preprocessor">#include &quot;doctest.h&quot;</span></div>
</div><!-- fragment --><p>appears in <em>exactly</em> one translation unit (source file). Use as many additional source files as you need for your tests - partitioned however makes most sense for your way of working. Each additional file needs only to <code>#include "doctest.h"</code> - do not repeat the <code>#define</code>!</p>
<p>In fact it is usually a good idea to put the block with the <code>#define</code> in its own source file.</p>
<h1><a class="anchor" id="autotoc_md182"></a>
Next steps</h1>
<p>This has been a brief introduction to get you up and running with <b>doctest</b> and to point out some of the key differences between <b>doctest</b> and other frameworks you may already be familiar with. This will get you going quite far already and you are now in a position to dive in and write some tests.</p>
<p>Of course there is more to learn - see the ever-growing <a href="readme.md#reference"><b>reference</b></a> section for what's available.</p>
<hr  />
<p><a href="readme.md#reference">Home</a></p>
<p><img src="../../scripts/data/logo/icon_2.svg" alt="" style="pointer-events: none;" class="inline"/></p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0
</small></address>
</body>
</html>
